namespace = nepotism

# These events handle the new system for trying to manipulate successions
# This event should be called both on death and whenever a character would otherwise abdicate
character_event = {
	id = nepotism.0
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		independent = no
		any_demesne_title = { has_law = succ_appointment }
		NOT = { any_courtier = { has_minor_title = title_expected_successor } }
		NOT = { any_vassal = { has_minor_title = title_expected_successor } }
		OR = {
			AND = {
				is_corporate_trigger = yes
				liege = { is_corporate_trigger = no }
			}
			AND = {
				is_military_trigger = yes
				liege = { is_military_trigger = no }
			}
			AND = {
				is_administrative_trigger = yes
				liege = { is_administrative_trigger = no }
			}
		}
	}
	
	immediate = {
		liege = {
			ROOT = {
				# Give away all titles above county level
				any_demesne_title = {
					limit = {
						has_law = succ_appointment
						higher_tier_than = COUNT
					}
					grant_title = PREVPREV
				}
			}
		}
		# Create a new character to inherit all lower titles
		random_list = {
			50 = {
				create_random_priest = {
					random_traits = yes
					culture = ROOT
					religion = ROOT
					dynasty = culture
					age = 25
					female = yes
				}
				new_character = {
					give_minor_title = title_expected_successor
					set_dynasty_flag = flag_approved_dynasty
				}
			}
			50 = {
				create_random_priest = {
					random_traits = yes
					culture = ROOT
					religion = ROOT
					dynasty = culture
					age = 25
					female = no
				}
				new_character = {
					give_minor_title = title_expected_successor
					set_dynasty_flag = flag_approved_dynasty
				}
			}
		}
		character_event = { id = nepotism.1 }
	}
}
# Likewise this one
character_event = {
	id = nepotism.1
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		independent = no
		any_demesne_title = { has_law = succ_appointment }
		OR = {
			any_courtier = { has_minor_title = title_expected_successor }
			any_vassal = { has_minor_title = title_expected_successor }
		}
	}
	
	immediate = {
		# All titles are appointed
		if = {
			limit = {
				NOT = {
					any_demesne_title = {
						NOT = {
							AND = {
								has_law = succ_appointment
								OR = {
									higher_tier_than = baron
									is_capital = no
								}
							}
						}
					}
				}
			}
			random_realm_character = {
				limit = {
					liege = { character = ROOT }
					has_minor_title = title_expected_successor
				}
				set_character_flag = flag_not_a_usurper
				ROOT = { abdicate_to = PREV }
				character_event = { id = nepotism.2 }
			}
		}
		# Has mixed succession laws, liege
		if = {
			limit = {
				any_demesne_title = {
					NOT = {
						AND = {
							has_law = succ_appointment
							OR = {
								higher_tier_than = baron
								is_capital = no
							}
						}
					}
				}
			}
			liege = {
				random_realm_character = {
					limit = {
						liege = { character = ROOT }
						has_minor_title = title_expected_successor
					}
					set_character_flag = flag_not_a_usurper
					ROOT = {
						any_demesne_title = {
							limit = {
								has_law = succ_appointment
								OR = {
									higher_tier_than = baron
									is_capital = no
								}
							}
							usurp_title_plus_barony_if_unlanded = PREVPREV
						}
					}
					set_defacto_liege = PREV
					character_event = { id = nepotism.2 }
				}
			}
		}
	}
}

# Bounce to get new holder
character_event = {
	id = nepotism.2
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		liege = { character_event = { id = nepotism.3 } }
	}
}

# Bounce to get liege
character_event = {
	id = nepotism.3
	desc = "EVTDESCNEPOTISM3"
	is_triggered_only = yes
	notification = yes
	
	immediate = {
		FROM = { FROM = { character_event = { id = nepotism.4 } } }
	}
	
	option = { name = "EVTOPTCONFIRM" } # Escape option
}

# Bounce to remember old holder
character_event = {
	id = nepotism.4
	desc = "EVTDESCNEPOTISM4"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	show_from_from = yes
	
	immediate = {
		FROM = { FROM = { letter_event = { id = nepotism.5 } } }
	}
	
	option = { name = "EVTOPTCONFIRM" }
}

# Inform new holder
letter_event = {
	id = nepotism.5
	desc = "EVTDESCNEPOTISM5"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = "EVTOPTCONFIRM"
		if = {
			limit = {
				dynasty = FROMFROM
				NOT = { religion = neo_feudal }
				NOT = { religion = terran_imperial }
				NOT = { religion = bio_directionist }
			}
			religion_authority = { modifier = nepotism years = 10 }
		}
		clr_character_flag = flag_not_a_usurper
	}
}

# Characters who can be involved:
#	The Appointer: This is either the Current Holder's liege, liege's regent, or liege's prime minister, depending
#		In any case, they have the authority to appoint people to the office, and are the ones who have to be pleased
#	The Nominee: The person being considered for the office. They must be a vassal of the current holder.
#	The Patron: The person nominating the Nominee. Can BE the Nominee, or a relative thereof.
#		In extreme cases, can also be the Appointer.
#	The Current Holder: The current holder of the office. Can be the Patron or the Current Successor's Patron.
#	The Current Successor: The last person to be promised the job. Will be very upset if the Appointer changes their mind.
#	The Current Successor's Patron: The name is pretty straightforward.

# 1XX: Self-Nomination Series
# 100: Self-Nominator considers
character_event = {
	id = nepotism.100
	desc = "EVTDESCNEPOTISM100"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	# Liegeliege is the appointer
	option = {
		trigger = {
			liege = { liege = { always = yes } } #Liegeliege exists
			liege = {
				liege = {
					# Liegeliege has no regent or prime minister
					has_regent = no
				}
			}
		}
		name = "EVTOPTANEPOTISM100"
		liege = { liege = { letter_event = { id = nepotism.101 tooltip = "EVTTOOLTIPNEPOTISM101" } } }
		clr_character_flag = flag_appointment_nomination_cooldown
		set_character_flag = flag_appointment_nomination_cooldown
		ai_chance = { factor = 100 }
	}
	
	# Liegeliege is the appointer and a favor is available
	option = {
		trigger = {
			liege = { liege = { always = yes } } #Liegeliege exists
			liege = {
				liege = {
					# Liegeliege has no regent or prime minister
					has_regent = no
				}
			}
			# Liegeliege does not owe or is owed a favor
			liege = {
				liege = {
					NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
					NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
				}
			}
		}
		name = "EVTOPTOFFERAFAVOR"
		set_character_flag = flag_offering_a_favor
		liege = { liege = { letter_event = { id = nepotism.101 tooltip = "EVTTOOLTIPNEPOTISM101" } } }
		clr_character_flag = flag_appointment_nomination_cooldown
		set_character_flag = flag_appointment_nomination_cooldown
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 2
				trait = carefree
			}
			modifier = {
				factor = 0.5
				trait = disciplined
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 100 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 90 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 80 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 70 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 60 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 50 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 40 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 30 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 20 } } }
			}
			modifier = {
				factor = 0.8
				liege = { liege = { opinion = { who = ROOT value = 10 } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -9 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -19 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -29 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -39 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -49 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -59 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -69 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -79 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -89 } } } }
			}
			modifier = {
				factor = 1.25
				liege = { liege = { NOT = { opinion = { who = ROOT value = -99 } } } }
			}
		}
	}
	
	# Regent is the appointer
	option = {
		trigger = {
			liege = { liege = { always = yes } } #Liegeliege exists
			# Liegeliege has a regent but no prime minister
			liege = { liege = { has_regent = yes } }
		}
		name = "EVTOPTBNEPOTISM100"
		liege = {
			liege = {
				random_realm_character = {
					limit = {
						has_minor_title = title_regent
						liege = { character = PREVPREV }
					}
					letter_event = { id = nepotism.101 tooltip = "EVTTOOLTIPNEPOTISM101" }
				}
			}
		}
		clr_character_flag = flag_appointment_nomination_cooldown
		set_character_flag = flag_appointment_nomination_cooldown
		ai_chance = { factor = 100 }
	}
	
	# Regent is the appointer and a favor is available
	option = {
		trigger = {
			liege = { liege = { always = yes } } #Liegeliege exists
			# Liegeliege has a regent but no prime minister
			liege = {
				liege = {
					any_realm_character = {
						has_minor_title = title_regent
						liege = { character = PREVPREV }
						# Regent does not owe or is owed a favor
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
						NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
					}
				}
			}
		}
		name = "EVTOPTOFFERAFAVOR"
		set_character_flag = flag_offering_a_favor
		liege = {
			liege = {
				random_realm_character = {
					limit = {
						has_minor_title = title_regent
						liege = { character = PREVPREV }
					}
					letter_event = { id = nepotism.101 tooltip = "EVTTOOLTIPNEPOTISM101" }
				}
			}
		}
		clr_character_flag = flag_appointment_nomination_cooldown
		set_character_flag = flag_appointment_nomination_cooldown
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 2
				trait = carefree
			}
			modifier = {
				factor = 0.5
				trait = disciplined
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 100 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 90 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 80 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 70 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 60 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 50 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 40 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 30 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 20 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							opinion = { who = ROOT value = 10 }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -9 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -19 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -29 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -39 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -49 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -59 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -69 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -79 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -89 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				liege = {
					liege = {
						any_realm_character = {
							has_minor_title = title_regent
							liege = { character = PREVPREV }
							NOT = { opinion = { who = ROOT value = -99 } }
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTNEVERMIND"
		clr_character_flag = flag_making_appointment_nomination
		ai_chance = { factor = 0 }
	}
}

# 101: The Appointer considers a self-nomination
letter_event = {
	id = nepotism.101
	desc = "EVTDESCNEPOTISM101"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTACCEPT"
		log = "[Root.GetBestName] accepted [From.GetBestName]'s self-nomination to succeed [From.Liege.GetBestName]."
		FROM = {
			liege = {
				random_realm_character = {
					limit = {
						has_minor_title = title_expected_successor
						liege = { character = PREVPREV }
					}
					remove_title = title_expected_successor
					hidden_tooltip = { character_event = { id = nepotism.104 } }
					remove_opinion = { who = ROOT modifier = opinion_promised_me_appointment }
					opinion = { who = ROOT modifier = opinion_retracted_promised_appointment }
					if = {
						limit = { has_opinion_modifier = { who = ROOT modifier = opinion_favor_ongoing_appointment } }
						character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
					}
					any_dynasty_member = {
						limit = {
							reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
							has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
						}
						remove_opinion = { who = ROOT modifier = opinion_promised_relative_appointment }
						opinion = { who = ROOT modifier = opinion_retracted_relative_appointment }
						if = {
							limit = { has_opinion_modifier = { who = ROOT modifier = opinion_favor_ongoing_appointment } }
							character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
						}
					}
				}
				hidden_tooltip = { character_event = { id = nepotism.103 } }
			}
			letter_event = { id = nepotism.102 tooltip = "EVTTOOLTIPNEPOTISM102" }
			set_character_flag = flag_expected_successor
			give_minor_title = title_expected_successor
			clr_character_flag = flag_expected_successor
			opinion = { who = ROOT modifier = opinion_promised_me_appointment }
			if = {
				limit = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
				custom_tooltip = {
					text = "FAVORFULFILLED"
					remove_opinion = { who = ROOT modifier = opinion_owes_me_a_favor }
					opinion = { who = ROOT modifier = opinion_favor_ongoing_appointment }
					letter_event = { id = favor.100 } # Favor system not yet implemented
				}
			}
		}
		if = {
			limit = { FROM = { has_character_flag = flag_offering_a_favor } }
			FROM = {
				custom_tooltip = {
					text = "EVTTOOLTIPWILLOWEFAVOR"
					hidden_tooltip = {
						reverse_opinion = { who = ROOT modifier = opinion_owes_me_a_favor }
						reverse_opinion = { who = ROOT modifier = opinion_favor_type_political }
					}
				}
			}
		}
		hidden_tooltip = { opinion = { who = FROM modifier = opinion_recent_request } }
		ai_chance = {
			factor = 10
			# Nominee is offering a favor
			modifier = {
				factor = 2
				FROM = { has_character_flag = flag_offering_a_favor }
			}
			modifier = {
				factor = 2
				FROM = {
					has_character_flag = flag_offering_a_favor
					OR = {
						NOT = { has_character_flag = flag_defaulted_favor }
						had_character_flag = { flag = flag_defaulted_favor days = 365 }
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					has_character_flag = flag_offering_a_favor
					OR = {
						NOT = { has_character_flag = flag_defaulted_favor }
						had_character_flag = { flag = flag_defaulted_favor days = 730 }
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					has_character_flag = flag_offering_a_favor
					OR = {
						NOT = { has_character_flag = flag_defaulted_favor }
						had_character_flag = { flag = flag_defaulted_favor days = 1460 }
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					has_character_flag = flag_offering_a_favor
					OR = {
						NOT = { has_character_flag = flag_defaulted_favor }
						had_character_flag = { flag = flag_defaulted_favor days = 2920 }
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					has_character_flag = flag_offering_a_favor
					OR = {
						NOT = { has_character_flag = flag_defaulted_favor }
						had_character_flag = { flag = flag_defaulted_favor days = 5840 }
					}
				}
			}
			# Opinion of nominee
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 100 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 90 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 80 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 70 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 60 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 50 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 40 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 30 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 20 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 10 }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -9 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -19 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -29 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -39 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -49 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -59 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -69 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -79 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -89 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -99 } }
			}
			# Opinion of current candidate
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 100 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 90 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 70 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 60 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 50 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 40 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 30 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 20 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							reverse_opinion = { who = ROOT value = 10 }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -9 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -19 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -29 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -39 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -49 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -59 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -69 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -79 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -89 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							NOT = { reverse_opinion = { who = ROOT value = -99 } }
						}
					}
				}
			}
			# Opinion of the current holder's patron (if they are not the new nominee's patron)
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 100 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 90 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 80 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 70 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 60 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 50 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 40 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 30 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 20 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								reverse_opinion = { who = ROOT value = 10 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -9 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -19 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -29 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -39 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -49 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -59 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -69 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -79 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -89 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { reverse_opinion = { who = ROOT value = -99 } }
							}
						}
					}
				}
			}
			# Favors owed
			modifier = {
				factor = 10
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_owes_me_a_favor }
			}
			modifier = {
				factor = 0.1
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							OR = {
								has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor }
								any_dynasty_member = {
									reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
									has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
									has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor }
								}
							}
						}
					}
				}
			}
			# Don't replace own nominees unless VERY good reason
			modifier = {
				factor = 0.01
				FROM = {
					liege = {
						any_realm_character = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
							has_opinion_modifier = { who = ROOT modifier = opinion_nominated_me_for_appointment }
						}
					}
				}
			}
			# Respect for current occupant's suggestions
			modifier = {
				factor = 5
				FROM = { FROM = { any_vassal = { character = PREV } } }
			}
			# Qualifications
			modifier = {
				factor = 10
				FROM = { liege = { is_military_trigger = no } }
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 1
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 2
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 3
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 4
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 5
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 6
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 7
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 8
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 9
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 10
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 11
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 12
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 13
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 14
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 15
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 16
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 17
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 18
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 19
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 20
				}
			}
			# Current successor's martial skill
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 1
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 2
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 3
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 4
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 5
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 6
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 7
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 8
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 9
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 10
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 11
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 12
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 13
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 14
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 15
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 16
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 17
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 18
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 19
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 20
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTREFUSE"
		log = "[Root.GetBestName] rejected [From.GetBestName]'s self-nomination to succeed [From.Liege.GetBestName]."
		FROM = {
			clr_character_flag = flag_offering_a_favor
			if = {
				limit = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
				character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
			}
			hidden_tooltip = {
				liege = {
					random_realm_character = {
						limit = {
							has_minor_title = title_expected_successor
							liege = { character = PREVPREV }
						}
						character_event = { id = nepotism.108 }
					}
					character_event = { id = nepotism.107 }
				}
			}
			opinion = { who = ROOT modifier = opinion_refused_me_appointment }
			letter_event = { id = nepotism.106 tooltip = "EVTTOOLTIPNEPOTISM106" }
		}
		hidden_tooltip = { opinion = { who = FROM modifier = opinion_recent_request } }
		ai_chance = { factor = 100 }
	}
}

# 102: Appointer Approves of Self-Nomination
#	Inform the Nominee
letter_event = {
	id = nepotism.102
	desc = "EVTDESCNEPOTISM102"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTANEPOTISM102"
		clr_character_flag = flag_making_appointment_nomination
	}
}

# 103: Appointer Approves of Self-Nomination
#	Inform the current holder
character_event = {
	id = nepotism.103
	desc = "EVTDESCNEPOTISM103"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	show_from_from = yes
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTCONFIRM"
	}
}

# 104: Appointer Approves of Self-Nomination
#	Inform the current successor
character_event = {
	id = nepotism.104
	desc = "EVTDESCNEPOTISM104"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	show_from_from = yes
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTANEPOTISM104"
		opinion = { who = FROMFROM modifier = opinion_stole_promised_appointment }
		liege = {
			any_demesne_title = {
				limit = { has_law = succ_appointment }
				add_weak_claim = ROOT
			}
		}
		hidden_tooltip = {
			any_dynasty_member = {
				limit = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_nominated_me_for_appointment } }
				character_event = { id = nepotism.105 }
			}
		}
	}
}

# 105: Appointer Approves Self-Nomination
#	Inform current successor's patron
character_event = {
	id = nepotism.105
	desc = "EVTDESCNEPOTISM105"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = { name = "EVTOPTANEPOTISM105" }
}

# 106: Appointer Rejects Self-Nomination
#	Inform nominee
letter_event = {
	id = nepotism.106
	desc = "EVTDESCNEPOTISM106"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTANEPOTISM106"
		clr_character_flag = flag_making_appointment_nomination
	}
}

# 107: Appointer Rejects Self-Nomination
#	Inform current holder
character_event = {
	id = nepotism.107
	desc = "EVTDESCNEPOTISM107"
	is_triggered_only = yes
	show_from_from = yes
	notification = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 108: Appointer Rejects Self-Nomination
#	Inform current successor
character_event = {
	id = nepotism.108
	desc = "EVTDESCNEPOTISM108"
	is_triggered_only = yes
	show_from_from = yes
	notification = yes
	
	immediate = { opinion = { who = FROMFROM modifier = opinion_attempted_appointment_theft } }
	
	option = { name = "EVTOPTCONFIRM" }
}

# 2XX: Nomination by a patron relative
# 200: Patron considers nomination
character_event = {
	id = nepotism.200
	desc = "EVTDESCNEPOTISM200"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	# This should fire only if ROOT holds appointment authority over the target
	option = {
		trigger = {
			any_realm_character = {
				has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
				liege = { liege = { always = yes } }
				OR = {
					# Liegeliege
					liege = {
						liege = {
							character = ROOT
							has_regent = no
						}
					}
					# Regent
					liege = {
						liege = {
							has_regent = yes
							ROOT = {
								has_minor_title = title_regent
								liege = { character = PREVPREV }
							}
						}
					}
				}
			}
		}
		name = "EVTOPTANEPOTISM200"
		random_realm_character = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee } }
			letter_event = { id = nepotism.201 tooltip = "EVTTOOLTIP201" }
			hidden_tooltip = { remove_opinion = { who = ROOT modifier = opinion_appointment_nominee } }
		}
	}
	
	
	# Liegeliege is the appointer
	option = {
		trigger = {
			any_realm_character = {
				has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
				liege = { liege = { always = yes } } #Liegeliege exists
				liege = {
					liege = {
						# Liegeliege has no regent or prime minister
						NOT = { character = ROOT }
						has_regent = no
					}
				}
			}
		}
		name = "EVTOPTBNEPOTISM200"
		random_realm_character = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee } }
			character_event = { id = nepotism.205 tooltip = "EVTDESCTOOLTIPNEPOTISM205" }
			hidden_tooltip = { remove_opinion = { who = ROOT modifier = opinion_appointment_nominee } } # Remove the targeting opinion modifier
		}
		ai_chance = { factor = 100 }
	}
	
	# Liegeliege is the appointer and a favor is available
	option = {
		trigger = {
			any_realm_character = {
				has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
				liege = { liege = { always = yes } } #Liegeliege exists
				liege = {
					liege = {
						NOT = { character = ROOT }
						# Liegeliege has no regent or prime minister
						has_regent = no
						
						# Liegeliege does not owe or is owed a favor
						NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
						NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
					}
				}
			}
		}
		name = "EVTOPTOFFERAFAVOR"
		set_character_flag = flag_offering_a_favor
		random_realm_character = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee } }
			character_event = { id = nepotism.205 tooltip = "EVTDESCTOOLTIPNEPOTISM205" }
			hidden_tooltip = { remove_opinion = { who = ROOT modifier = opinion_appointment_nominee } } # Remove the targeting opinion modifier
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 2
				trait = carefree
			}
			modifier = {
				factor = 0.5
				trait = disciplined
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 100 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 90 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 80 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 70 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 60 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 50 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 40 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 30 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 20 } } }
				}
			}
			modifier = {
				factor = 0.8
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { opinion = { who = ROOT value = 10 } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -9 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -19 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -29 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -39 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -49 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -59 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -69 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -79 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -89 } } } }
				}
			}
			modifier = {
				factor = 1.25
				any_realm_character = {
					has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
					liege = { liege = { NOT = { opinion = { who = ROOT value = -99 } } } }
				}
			}
		}
	}
	
	# Regent is the appointer
	option = {
		trigger = {
			any_realm_character = {
				has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
				liege = { liege = { always = yes } } #Liegeliege exists
				# Liegeliege has a regent
				liege = { liege = { has_regent = yes } }
			}
		}
		name = "EVTOPTCNEPOTISM200"
		random_realm_character = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee } }
			character_event = { id = nepotism.205 tooltip = "EVTDESCTOOLTIPNEPOTISM205" }
			hidden_tooltip = { remove_opinion = { who = ROOT modifier = opinion_appointment_nominee } } # Remove the targeting opinion modifier
		}
		ai_chance = { factor = 100 }
	}
	
	# Regent is the appointer and a favor is available
	option = {
		trigger = {
			any_realm_character = {
				has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee }
				liege = { liege = { always = yes } } #Liegeliege exists
				# Regent does not owe or is owed a favor
				liege = {
					liege = {
						has_regent = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_regent
							NOT = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
							NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
						}
					}
				}
			}
		}
		name = "EVTOPTOFFERAFAVOR"
		set_character_flag = flag_offering_a_favor
		random_realm_character = {
			limit = { has_opinion_modifier = { who = ROOT modifier = opinion_appointment_nominee } }
			character_event = { id = nepotism.205 tooltip = "EVTDESCTOOLTIPNEPOTISM205" }
			hidden_tooltip = { remove_opinion = { who = ROOT modifier = opinion_appointment_nominee } } # Remove the targeting opinion modifier
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = content
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 2
				trait = carefree
			}
			modifier = {
				factor = 0.5
				trait = disciplined
			}
		}
	}
	
	option = {
		name = "EVTOPTNEVERMIND"
		hidden_tooltip = { any_realm_character = { remove_opinion = { who = ROOT modifier = opinion_appointment_nominee } } }
		clr_character_flag = flag_making_appointment_nomination
		ai_chance = { factor = 0 }
	}
}

# 201: Patron is Appointer
#	Inform nominee
letter_event = {
	id = nepotism.201
	desc = "EVTDESCNEPOTISM201"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTANEPOTISM201"
		hidden_tooltip = { FROM = { character_event = { id = nepotism.220 } } }
		clr_character_flag = flag_appointment_nomination_cooldown
		set_character_flag = flag_appointment_nomination_cooldown
	}
}

# 220: Patron is Appointer
#	Bounce the event to get localization scopes
character_event = {
	id = nepotism.220
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		FROM = {
			liege = {
				any_realm_character = {
					limit = {
						liege = { character = PREVPREV }
						has_minor_title = title_expected_successor
					}
					remove_title = title_expected_successor
					hidden_tooltip = { character_event = { id = nepotism.203 } }
					remove_opinion = { who = ROOT modifier = opinion_promised_me_appointment }
					opinion = { who = ROOT modifier = opinion_retracted_promised_appointment }
					opinion = { who = PREVPREV modifier = opinion_stole_promised_appointment }
					if = {
						limit = { has_opinion_modifier = { who = ROOT modifier = opinion_favor_ongoing_appointment } }
						character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
					}
					any_realm_character = {
						limit = { has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment } }
						remove_opinion = { who = ROOT modifier = opinion_promised_relative_appointment }
						opinion = { who = ROOT modifier = opinion_retracted_relative_appointment }
						hidden_tooltip = { character_event = { id = nepotism.204 } }
						if = {
							limit = { has_opinion_modifier = { who = ROOT modifier = opinion_favor_ongoing_appointment } }
							character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
						}
					}
				}
				character_event = { id = nepotism.202 }
			}
			set_character_flag = flag_expected_successor
			give_minor_title = title_expected_successor
			clr_character_flag = flag_expected_successor
			opinion = { who = ROOT modifier = opinion_promised_me_appointment }
			hidden_tooltip = { remove_opinion = { who = ROOT modifier = opinion_appointment_nominee } }
		}
		clr_character_flag = flag_making_appointment_nomination
	}
}

# 202: Patron is Appointer
#	Inform current holder
character_event = {
	id = nepotism.202
	desc = "EVTDESCNEPOTISM202"
	is_triggered_only = yes
	notification = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 203: Patron is Appointer
#	Inform current successor
character_event = {
	id = nepotism.203
	desc = "EVTDESCNEPOTISM203"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 204: Patron is Appointer
#	Inform current successor's patron
character_event = {
	id = nepotism.204
	desc = "EVTDESCNEPOTISM204"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 205: Patron nomination
#	Inform Nominee
character_event = {
	id = nepotism.205
	desc = "EVTDESCNEPOTISM205"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	# Liegeliege is appointer
	option = {
		name = "EVTOPTANEPOTISM205"
		if = {
			# Liegeliege is appointer
			limit = { liege = { liege = { has_regent = no } } }
			liege = { liege = { letter_event = { id = nepotism.206 tooltip = "EVTTOOLTIPNEPOTISM206" } } }
		}
		if = {
			# Regent is appointer
			limit = { liege = { liege = { has_regent = yes } } }
			liege = {
				liege = {
					random_realm_character = {
						limit = {
							has_minor_title = title_regent
							liege = { character = PREV }
						}
						letter_event = { id = nepotism.206 tooltip = "EVTTOOLTIPNEPOTISM206" }
					}
				}
			}
		}
		clr_character_flag = flag_appointment_nomination_cooldown
		set_character_flag = flag_appointment_nomination_cooldown
	}
}

# 206: Appointer considers Patron's nomination
letter_event = {
	id = nepotism.206
	desc = "EVTDESCNEPOTISM206"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTACCEPT"
		log = "[Root.GetBestName] accepted [FromFrom.GetBestName]'s nomination of [From.GetBestName] to succeed [From.Liege.GetBestName]."
		FROM = {
			liege = {
				random_realm_character = {
					limit = {
						has_minor_title = title_expected_successor
						liege = { character = PREVPREV }
					}
					remove_title = title_expected_successor
					hidden_tooltip = { character_event = { id = nepotism.210 } }
					remove_opinion = { who = ROOT modifier = opinion_promised_me_appointment }
					opinion = { who = ROOT modifier = opinion_retracted_promised_appointment }
					if = {
						limit = { has_opinion_modifier = { who = ROOT modifier = opinion_favor_ongoing_appointment } }
						character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
					}
					any_dynasty_member = {
						limit = {
							has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
							reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
							NOT = { character = FROMFROM }
						}
						hidden_tooltip = { character_event = { id = nepotism.211 } }
						remove_opinion = { who = ROOT modifier = opinion_promised_relative_appointment }
						opinion = { who = ROOT modifier = opinion_retracted_relative_appointment }
						if = {
							limit = { has_opinion_modifier = { who = ROOT modifier = opinion_favor_ongoing_appointment } }
							character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
						}
					}
				}
				hidden_tooltip = { character_event = { id = nepotism.209 } }
			}
			hidden_tooltip = { character_event = { id = nepotism.207 } }
			set_character_flag = flag_expected_successor
			give_minor_title = title_expected_successor
			clr_character_flag = flag_expected_successor
			opinion = { who = ROOT modifier = opinion_promised_me_appointment }
			FROM = {
				hidden_tooltip = { letter_event = { id = nepotism.208 } }
				opinion = { who = ROOT modifier = opinion_promised_relative_appointment }
				if = {
					limit = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
					custom_tooltip = {
						text = "WEFULFILLFAVOR"
						remove_opinion = { who = ROOT modifier = opinion_owes_me_a_favor }
						opinion = { who = ROOT modifier = opinion_favor_ongoing_appointment }
						letter_event = { id = favor.100 } # Favor system not yet implemented
					}
				}
				if = {
					limit = { has_character_flag = flag_offering_a_favor }
					custom_tooltip = {
						text = "THEYWILLOWEFAVOR"
						hidden_tooltip = {
							reverse_opinion = { who = ROOT modifier = opinion_owes_me_a_favor }
							reverse_opinion = { who = ROOT modifier = opinion_favor_type_political }
						}
					}
					clr_character_flag = flag_offering_a_favor
				}
			}
		}
		hidden_tooltip = { opinion = { who = FROMFROM modifier = opinion_recent_request } }
		ai_chance = {
			factor = 10
			# Patron is offering a favor
			modifier = {
				factor = 2
				FROM = { FROM = { has_character_flag = flag_offering_a_favor } }
			}
			modifier = {
				factor = 2
				FROM = {
					FROM = {
						has_character_flag = flag_offering_a_favor
						OR = {
							NOT = { has_character_flag = flag_defaulted_favor }
							had_character_flag = { flag = flag_defaulted_favor days = 365 }
						}
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					FROM = {
						has_character_flag = flag_offering_a_favor
						OR = {
							NOT = { has_character_flag = flag_defaulted_favor }
							had_character_flag = { flag = flag_defaulted_favor days = 730 }
						}
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					FROM = {
						has_character_flag = flag_offering_a_favor
						OR = {
							NOT = { has_character_flag = flag_defaulted_favor }
							had_character_flag = { flag = flag_defaulted_favor days = 1460 }
						}
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					FROM = {
						has_character_flag = flag_offering_a_favor
						OR = {
							NOT = { has_character_flag = flag_defaulted_favor }
							had_character_flag = { flag = flag_defaulted_favor days = 2920 }
						}
					}
				}
			}
			modifier = {
				factor = 2
				FROM = {
					FROM = {
						has_character_flag = flag_offering_a_favor
						OR = {
							NOT = { has_character_flag = flag_defaulted_favor }
							had_character_flag = { flag = flag_defaulted_favor days = 5840 }
						}
					}
				}
			}
			# Opinion of nominee
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 100 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 90 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 80 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 70 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 60 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 50 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 40 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 30 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 20 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROM value = 10 }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -9 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -19 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -29 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -39 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -49 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -59 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -69 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -79 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -89 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROM value = -99 } }
			}
			# Opinion of patron
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 100 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 90 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 80 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 70 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 60 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 50 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 40 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 30 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 20 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = FROMFROM value = 10 }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -9 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -19 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -29 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -39 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -49 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -59 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -69 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -79 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -89 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = FROMFROM value = -99 } }
			}
			# Opinion of current candidate
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 100 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 90 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 70 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 60 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 50 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 40 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 30 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 20 }
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							reverse_opinion = { who = ROOT value = 10 }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -9 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -19 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -29 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -39 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -49 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -59 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -69 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -79 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -89 } }
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							NOT = { reverse_opinion = { who = ROOT value = -99 } }
						}
					}
				}
			}
			# Opinion of the current holder's patron (if they are not the new nominee's patron)
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 100 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 90 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 80 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 70 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 60 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 50 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 40 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 30 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 20 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								reverse_opinion = { who = ROOT value = 10 }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -9 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -19 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -29 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -39 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -49 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -59 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -69 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -79 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -89 } }
							}
						}
					}
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							any_dynasty_member = {
								reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
								has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
								NOT = { character = FROMFROM }
								NOT = { reverse_opinion = { who = ROOT value = -99 } }
							}
						}
					}
				}
			}
			# Favors owed
			modifier = {
				factor = 10
				reverse_has_opinion_modifier = { who = FROMFROM modifier = opinion_owes_me_a_favor }
			}
			modifier = {
				factor = 0.1
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							OR = {
								has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor }
								any_dynasty_member = {
									reverse_has_opinion_modifier = { who = PREV modifier = opinion_nominated_me_for_appointment }
									has_opinion_modifier = { who = ROOT modifier = opinion_promised_relative_appointment }
									has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor }
								}
							}
						}
					}
				}
			}
			# Don't replace own nominees unless VERY good reason
			modifier = {
				factor = 0.01
				FROM = {
					liege = {
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							has_opinion_modifier = { who = ROOT modifier = opinion_nominated_me_for_appointment }
						}
					}
				}
			}
			# Respect for current occupant's suggestions
			modifier = {
				factor = 5
				FROM = { FROM = { any_vassal = { character = PREV } } }
			}
			# Qualifications
			modifier = {
				factor = 10
				FROM = { liege = { is_military_trigger = no } }
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 1
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 2
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 3
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 4
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 5
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 6
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 7
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 8
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 9
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 10
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 11
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 12
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 13
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 14
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 15
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 16
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 17
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 18
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 19
				}
			}
			modifier = {
				factor = 1.25
				FROM = {
					liege = { is_military_trigger = yes }
					martial = 20
				}
			}
			# Current successor's martial skill
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 1
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 2
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 3
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 4
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 5
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 6
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 7
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 8
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 9
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 10
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 11
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 12
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 13
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 14
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 15
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 16
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 17
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 18
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 19
						}
					}
				}
			}
			modifier = {
				factor = 0.8
				FROM = {
					liege = {
						is_military_trigger = yes
						any_realm_character = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
							martial = 20
						}
					}
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTREFUSE"
		log = "[Root.GetBestName] rejected [FromFrom.GetBestName]'s nomination of [From.GetBestName] to succeed [From.Liege.GetBestName]."
		FROM = {
			hidden_tooltip = {
				liege = {
					random_realm_character = {
						limit = {
							liege = { character = PREVPREV }
							has_minor_title = title_expected_successor
						}
						character_event = { id = nepotism.215 }
						opinion = { who = FROM modifier = opinion_attempted_appointment_theft }
					}
					character_event = { id = nepotism.214 }
				}
			}
			opinion = { who = ROOT modifier = opinion_refused_me_appointment }
			hidden_tooltip = { character_event = { id = nepotism.212 tooltip = "EVTTOOLTIPNEPOTISM212" } }
			FROM = {
				opinion = { who = ROOT modifier = opinion_refused_relative_appointment }
				letter_event = { id = nepotism.213 tooltip = "EVTTOOLTIPNEPOTISM213" }
				clr_character_flag = flag_offering_a_favor
				if = {
					limit = { has_opinion_modifier = { who = ROOT modifier = opinion_owes_me_a_favor } }
					character_event = { id = favor.200 tooltip = "EVTTOOLTIPFAVOR200" } # Favor system not yet implemented
				}
			}
		}
		hidden_tooltip = { opinion = { who = FROMFROM modifier = opinion_recent_request } }
	}
}

# 207: Appointer Approves Patron's Nomination
#	Inform Nominee
character_event = {
	id = nepotism.207
	desc = "EVTDESCNEPOTISM207"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 208: Appointer Approves Patron's Nomination
#	Inform Patron
letter_event = {
	id = nepotism.208
	desc = "EVTDESCNEPOTISM208"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTCONFIRM"
		clr_character_flag = flag_making_appointment_nomination
	}
}

# 209: Appointer Approves Patron's Nomination
#	Inform Current Holder
character_event = {
	id = nepotism.209
	desc = "EVTDESCNEPOTISM202"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	show_from_from = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 210: Appointer Approves Patron's Nomination
#	Inform Current Successor
character_event = {
	id = nepotism.210
	desc = "EVTDESCNEPOTISM203"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	show_from_from = yes
	
	immediate = { opinion = { who = FROMFROM modifier = opinion_stole_promised_appointment } }
	
	option = { name = "EVTOPTCONFIRM" }
}

# 211: Appointer Approves Patron's Nomination
#	Inform Current Successor's Patron
character_event = {
	id = nepotism.211
	desc = "EVTDESCNEPOTISM204"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	show_from_from = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 212: Appointer Rejects Patron's Nomination
#	Inform Nominee
character_event = {
	id = nepotism.212
	desc = "EVTDESCNEPOTISM212"
	picture = GFX_evt_council
	border = GFX_evt_normal_frame_diplomacy
	is_triggered_only = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 213: Appointer Rejects Patron's Nomination
#	Inform Patron
letter_event = {
	id = nepotism.213
	desc = "EVTDESCNEPOTISM213"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTANEPOTISM213"
		clr_character_flag = flag_making_appointment_nomination
	}
}

# 214: Appointer Rejects Patron's Nomination
#	Inform Current Holder
character_event = {
	id = nepotism.214
	desc = "EVTDESCNEPOTISM214"
	is_triggered_only = yes
	show_from_from = yes
	notification = yes
	
	option = { name = "EVTOPTCONFIRM" }
}

# 215: Appointer Rejects Patron's Nomination
#	Inform Current Successor
character_event = {
	id = nepotism.215
	desc = "EVTDESCNEPOTISM215"
	is_triggered_only = yes
	show_from_from = yes
	notification = yes
	
	immediate = { opinion = { who = FROMFROM modifier = opinion_attempted_appointment_theft } }
	
	option = { name = "EVTOPTCONFIRM" }
}

####
# Firing appointed vassals
####

letter_event = {
	id = nepotism.300
	desc = "EVTDESCNEPOTISM300"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTACCEPT"
		clr_character_flag = flag_being_fired
		custom_tooltip = {
			text = "FORFEITAPPOINTEDTITLES"
			hidden_tooltip = {
				character_event = { id = nepotism.0 }
				character_event = { id = nepotism.1 }
				liege = { letter_event = { id = nepotism.301 } }
			}
		}
		ai_chance = {
			factor = 25
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 100 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 90 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 80 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 70 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 60 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 50 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 40 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 30 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 20 }
			}
			modifier = {
				factor = 1.25
				opinion = { who = liege value = 10 }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -9 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -19 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -29 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -39 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -49 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -59 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -69 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -79 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -89 } }
			}
			modifier = {
				factor = 0.8
				NOT = { opinion = { who = liege value = -99 } }
			}
			modifier = {
				factor = 2
				NOT = { relative_power_to_liege = 0.5 }
				NOT = { trait = lunatic }
				NOT = { trait = radical }
				NOT = { trait = imbecile }
			}
			modifier = {
				factor = 2
				NOT = { relative_power_to_liege = 1.0 }
				NOT = { trait = lunatic }
				NOT = { trait = radical }
				NOT = { trait = imbecile }
				NOT = { trait = slow }
				NOT = { trait = brave }
			}
			modifier = {
				factor = 2
				NOT = { relative_power_to_liege = 2.0 }
				NOT = { trait = lunatic }
				NOT = { trait = radical }
				NOT = { trait = imbecile }
				NOT = { trait = slow }
				trait = craven
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 2
				trait = content
			}
			modifier = {
				factor = 2
				trait = friendly
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 0.5
				trait = cold
			}
			modifier = {
				factor = 0.5
				trait = brave
			}
			modifier = {
				factor = 5
				any_dynasty_member = {
					liege = { character = ROOT }
					has_minor_title = title_expected_successor
				}
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.1 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.2 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.3 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.4 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.5 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.6 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.7 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.8 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 0.9 }
			}
			modifier = {
				factor = 1.25
				liege = { religion_authority = 1.0 }
			}
		}
	}
	# Attempts to declare independence
	option = {
		trigger = {
			NOT = { tier = baron } # For now, barons cannot refuse resignation demands
			NOT = {
				liege = {
					primary_title = {
						OR = {
							claimed_by = ROOT
							ROOT = { dejure_liege_title = { title = PREVPREV } }
						}
					}
				}
			}
		}
		name = "EVTOPTREFUSE"
		liege = {
			ROOT = {
				any_demesne_title = {
					limit = { has_law = succ_appointment }
					add_claim = PREV
				}
			}
		}
		clr_character_flag = flag_being_fired
		liege = {
			reverse_war = {
				target = ROOT
				casus_belli = bid_for_independence
			}
		}
		ai_chance = {
			factor = 75
		}
	}
	# Starts a civil war
	option = {
		trigger = {
			liege = {
				primary_title = {
					OR = {
						claimed_by = ROOT
						ROOT = { dejure_liege_title = { title = PREVPREV } }
					}
				}
			}
		}
		name = "EVTOPTREFUSE"
		liege = {
			ROOT = {
				any_demesne_title = {
					limit = { has_law = succ_appointment }
					add_claim = PREV
				}
			}
		}
		clr_character_flag = flag_being_fired
		set_character_flag = flag_launching_civil_war
		liege = {
			primary_title = {
				holder_scope = {
					reverse_war = {
						target = ROOT
						casus_belli = civil_war
						thirdparty_title = PREV
					}
				}
			}
		}
		ai_chance = {
			factor = 75
		}
	}
}
letter_event = {
	id = nepotism.301
	desc = "EVTDESCNEPOTISM301"
	border = GFX_evt_letter_frame_diplomacy
	is_triggered_only = yes
	
	option = { name = "EVTOPTCONFIRM" }
}